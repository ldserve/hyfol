{%- comment -%}

---class_name: string
---show_img_tag: boolean
---show_transparent_tag: boolean

{%- endcomment -%}

{%- assign custom = false -%}

{% for tag in product.tags %}
	{%- if tag contains 'CustomPromotion' -%}
		{%- assign custom = true -%}
		{%- assign text = tag | split: '-' -%}
		{%- assign custom_tag = text[1] | strip -%}
		{% break %}
	{%- endif -%}
{% endfor %}


{%- if custom -%}

	{%- assign custome_tags = settings.custome_tag_ui | strip_html | split: ',' -%}

	{%- comment -%}------tag 标签图-------{%- endcomment -%}
	{%- if settings.tag_layout=="label" -%}
		{%- assign imgtag_list = settings.activity_img_tag | split: ',' -%}

		{%- for tag_str in imgtag_list -%}
			{%- assign tag_item = tag_str | strip | strip_html | split: '=' -%}

			{%- if custom_tag contains tag_item[0] -%}
				{%- assign tag_url = tag_item[1] -%}
				{% break %}
			{%- endif -%}
			
		{%- endfor -%}


			{% if show_img_tag %}
			{%- comment -%}----详情页活动链接-------{%- endcomment -%}

			{% assign CustomPromotionUrlList = settings.CustomPromotionUrl | strip_html | split : ',' %}
			{% for CustomPromotionUrItem in CustomPromotionUrlList %}
				{% assign CustomPromotionUrItemAll = CustomPromotionUrItem | split : '=' %}
				{% assign CustomPromotionUrItemName = CustomPromotionUrItemAll[0] | strip %}
				{% if CustomPromotionUrItemName == custom_tag %}
					{% assign CustomPromotionUrItemUrl = CustomPromotionUrItemAll[1] %}
					{%- break -%}
				{% endif %}
			{% endfor %}

				<a class="custom-activity-tag {{class_name}}" style="position: relative;" href="{{CustomPromotionUrItemUrl}}">
					<img class="activity-background-img" src="https://cdn.shopify.com/s/files/1/0595/0691/7535/files/1b8e4b9dcaf3cf40c5a151ed9a65c9bf_e66ef695-324e-4a2b-a0a9-f2984eda75c8.jpg?v=1663755768" alt="">
					<div class="activity-text" >{{custom_tag}}</div>
				</a>

		{%- elsif tag_url != blank  -%}
		{%- comment -%}透明背景活动TAG{%- endcomment -%}

			<div class="activity-img-ui {{class_name}}" >
				<img src="{{tag_url}}" alt="">
				</div>

		{%- endif -%}

	{%- else -%}
		{%- comment -%}------------展示标签 指定 TAG 颜色--------------{%- endcomment -%}
		{%- for cus_tag in custome_tags -%}
			{%- assign tag_arr = cus_tag | split: ':' -%}
			{%- assign tag_heading = tag_arr[0] | strip-%}

			{%- if tag_heading contains custom_tag -%}
				{%- assign color_list = tag_arr[1] | split: '&' -%}
				{%- capture gradient_colors -%}--gradient-color-start: {{color_list[0]}}; --gradient-color-end: {{color_list[1]}};{%- endcapture -%}
				{% break %}
			{%- endif -%}
		{%- endfor -%}

		{%- if settings.tag_layout=='bookmark' -%}
			{%- if custom_tag == "Buy 4 Get EXTRA 20% Off" -%}
			{%- assign custom_tag = '4 FOR 20% Off' -%}
			{%- elsif custom_tag == "Choose 3 for $59" -%}
			{%- assign custom_tag = '3 FOR $59' -%}
			{%- elsif custom_tag == "Buy 1 get 2nd 50% OFF" -%}
			{%- assign custom_tag = '2ND 50% OFF' -%}
			{%- endif -%}
		{%- endif -%}

		<div class="activity-tag-ui activity-tag-ui-right  activity-ui-fade-in {%if settings.tag_layout=='bookmark'%}activity-label{%endif%} {{class_name}}"
			style="{{gradient_colors}} opacity: 1; height: auto;" >
			<div class="activity-ui-text">
				<div class="activity-ui-text_msg">{{custom_tag}}</div>
			</div>
		</div>

	{%- endif -%}

{%- endif -%}
